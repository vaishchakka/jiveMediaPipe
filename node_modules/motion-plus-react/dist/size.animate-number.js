import{jsx as e,jsxs as t}from"react/jsx-runtime";import{addScaleCorrector as n,motion as i,MotionConfigContext as r,useIsPresent as a,animate as l,AnimatePresence as o,LayoutGroup as c,MotionConfig as s,easeOut as u}from"motion/react";import{useRef as p,useEffect as y,forwardRef as d,useContext as f,useImperativeHandle as h,useLayoutEffect as m,useState as g,createContext as v,useMemo as x}from"react";const $="var(--mask-height, 0.15em)",k="var(--mask-width, 0.5em)",b=`calc(${k} / var(--invert-x, 1))`,D="#000 0, transparent 71%",w=`linear-gradient(to right, transparent 0, #000 ${b}, #000 calc(100% - ${b}), transparent),linear-gradient(to bottom, transparent 0, #000 ${$}, #000 calc(100% - ${$}), transparent 100%),radial-gradient(at bottom right, ${D}),radial-gradient(at bottom left, ${D}), radial-gradient(at top left, ${D}), radial-gradient(at top right, ${D})`,j=`100% calc(100% - ${$} * 2),calc(100% - ${b} * 2) 100%,${b} ${$},${b} ${$},${b} ${$},${b} ${$}`;function S({children:t,layoutDependency:n}){return e(i.span,{layout:!0,layoutDependency:n,"aria-hidden":!0,style:{display:"inline-flex","--invert-x":1,margin:`0 calc(-1*${k})`,padding:`calc(${$}/2) ${k}`,position:"relative",zIndex:-1,overflow:"clip",WebkitMaskImage:w,WebkitMaskSize:j,WebkitMaskPosition:"center, center, top left, top right, bottom right, bottom left",WebkitMaskRepeat:"no-repeat"},children:t})}function C(){const e=p(!0);return y((()=>{e.current=!1}),[]),e.current}function I(e){const{width:t,fontSize:n}=getComputedStyle(e);return parseFloat(t)/parseFloat(n)+"em"}n({"--invert-x":{correct:(e,{treeScale:t,projectionDelta:n})=>n.x.scale*t.x}});const M=new WeakMap,W=d((function({value:n,initialValue:o=n,...c},s){const{transition:u}=f(r),d=p(o).current,v=C(),x=p(null),k=p(null);h(s,(()=>k.current),[]);const b=p(new Array(10)),D=a(),w=D?n:0;m((()=>{x.current&&b.current[d]&&(x.current.style.width=I(b.current[d]))}),[]);const j=p(o);m((()=>{if(!x.current||w===j.current)return;const e=x.current.getBoundingClientRect(),t=k.current?.getBoundingClientRect(),n=e.height*(w-j.current)+(e.top-(t?t.top||0:e.top));return l(x.current,{y:[n,0]},u),()=>{j.current=w}}),[w]);const[S,W]=g();y((()=>{if(v&&d===w)return;if(!b.current[w])return;const e=I(b.current[w]);k.current&&M.set(k.current,e),W(e)}),[w]);const A=t=>e("span",{style:{display:"inline-block",padding:`calc(${$}/2) 0`},ref:e=>{b.current[t]=e},children:t},t);return e(i.span,{...c,ref:k,layout:"position","data-state":D?void 0:"exiting",style:{display:"inline-flex",justifyContent:"center",width:S},children:t("span",{ref:x,style:{display:"inline-flex",justifyContent:"center",flexDirection:"column",alignItems:"center",position:"relative"},children:[0!==w&&e("span",{style:{...z,bottom:"100%",left:0},children:new Array(w).fill(null).map(((e,t)=>A(t)))}),A(w),9!==w&&e("span",{style:{...z,top:"100%",left:0},children:new Array(9-w).fill(null).map(((e,t)=>A(w+t+1)))})]})})})),z={display:"flex",flexDirection:"column",alignItems:"center",position:"absolute",width:"100%"},A=v({justify:"left"}),L=d((function({partKey:t,type:n,children:r,layoutDependency:l,...c},s){const u=a(),{justify:p}=f(A);return e(i.span,{...c,"data-state":u?void 0:"exiting",style:{display:"inline-flex",justifyContent:p,padding:`calc(${$}/2) 0`,position:"relative"},layout:"position",layoutDependency:l,ref:s,children:e(o,{mode:"popLayout",anchorX:p,initial:!1,children:e(i.span,{layout:"right"===p&&"position",layoutDependency:l,initial:{opacity:0},animate:{opacity:[null,1]},exit:{opacity:[null,0]},style:{display:"inline-block",whiteSpace:"pre"},children:r},r)})})})),B=d((function({parts:n,justify:r="left",mode:a,style:l,name:c,layoutDependency:s,...u},d){const f=p(null);h(d,(()=>f.current),[]);const m=x((()=>({justify:r})),[r]),v=p(null),$=C(),[k,b]=g();return y((()=>{if(!v.current)return;if($)return void(f.current&&(f.current.style.width=I(v.current)));const e=Array.from(v.current.children).map((e=>{if(!(e instanceof HTMLElement))return;if("exiting"===e.dataset.state){const t=e.nextSibling;return e.remove(),()=>{v.current&&v.current.insertBefore(e,t)}}const t=M.get(e);if(!t)return;const n=e.style.width;return e.style.width=t,()=>{e.style.width=n}}));b(I(v.current));for(let t=e.length-1;t>=0;t--){const n=e[t];n&&n()}}),[n.map((e=>e.value)).join("")]),e(A.Provider,{value:m,children:e(i.span,{layoutDependency:s,...u,ref:f,className:`number-section-${c}`,style:{...l,display:"inline-flex",justifyContent:r,width:k},children:t("span",{ref:v,style:{display:"inline-flex",justifyContent:"inherit",position:"relative"},children:["â€‹",e(o,{mode:a,anchorX:r,initial:!1,children:n.map((t=>"integer"===t.type||"fraction"===t.type?e(W,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},value:t.value,initialValue:$?void 0:0,layoutDependency:s},t.key):e(L,{type:t.type,partKey:t.key,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},layoutDependency:s,children:t.value},"literal"===t.type?`${t.key}:${t.value}`:t.key)))})]})})})})),F={opacity:{duration:1,ease:u},layout:{type:"spring",duration:1,bounce:0},y:{type:"spring",duration:1,bounce:0}},N=d((function({children:n,locales:a,format:l,transition:o,style:u,suffix:p,prefix:y,...d},h){const m=x((()=>((e,{locales:t,format:n},i,r)=>{const a=new Intl.NumberFormat(t,n).formatToParts(Number(e));i&&a.unshift({type:"prefix",value:i}),r&&a.push({type:"suffix",value:r});const l=[],o=[],c=[],s=[],u={},p=e=>`${e}:${u[e]=(u[e]??-1)+1}`;let y="",d=!1,f=!1;for(const e of a){y+=e.value;const t="minusSign"===e.type||"plusSign"===e.type?"sign":e.type;switch(t){case"integer":d=!0,o.push(...e.value.split("").map((e=>({type:t,value:parseInt(e)}))));break;case"group":o.push({type:t,value:e.value});break;case"decimal":f=!0,c.push({type:t,value:e.value,key:p(t)});break;case"fraction":c.push(...e.value.split("").map((e=>({type:t,value:parseInt(e),key:p(t)}))));break;default:(d||f?s:l).push({type:t,value:e.value,key:p(t)})}}const h=[];for(let e=o.length-1;e>=0;e--)h.unshift({...o[e],key:p(o[e].type)});return{pre:l,integer:h,fraction:c,post:s,formatted:y}})(n,{locales:a,format:l},y,p)),[n,a,l]),{pre:g,integer:v,fraction:k,post:b,formatted:D}=m,w=f(r).transition;o=o??w??F;const{layoutDependency:j}=d,C=x((()=>{if(void 0!==j)return{layoutDependency:j,value:n}}),[j,n]);return e(c,{children:e(s,{transition:o,children:e(i.div,{...d,ref:h,layout:!0,layoutDependency:C,style:{lineHeight:1,...u,display:"inline-flex",isolation:"isolate",whiteSpace:"nowrap"},children:t(i.div,{layout:!0,layoutDependency:C,"aria-label":D,style:{display:"inline-flex",direction:"ltr",isolation:"isolate",position:"relative",zIndex:-1},children:[e(B,{style:{padding:`calc(${$}/2) 0`},layoutDependency:C,"aria-hidden":!0,justify:"right",mode:"popLayout",parts:g,name:"pre"}),t(S,{layoutDependency:C,children:[e(B,{layoutDependency:C,justify:"right",parts:v,name:"integer"}),e(B,{layout:"position",layoutDependency:C,parts:k,name:"fraction"})]}),e(B,{style:{padding:`calc(${$}/2) 0`},"aria-hidden":!0,layout:"position",layoutDependency:C,mode:"popLayout",parts:b,name:"post"})]})})})})}));export{N as AnimateNumber,F as DEFAULT_TRANSITION};
