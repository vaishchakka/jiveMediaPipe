{"version":3,"sources":["../../src/utils/inputFormatter.ts"],"sourcesContent":["import type { JSONContent } from '@tiptap/core';\n\n/**\n * Traverse a Tiptap JSONContent tree and extract plain text,\n * including handling of custom choice nodes (attrs.options/selectedOption).\n */\nexport function inputFormatter(content: JSONContent): string {\n\tlet result = '';\n\n\tfunction walk(node: JSONContent) {\n\t\tconst anyNode = node as any;\n\n\t\t// Extract text nodes\n\t\tif (typeof anyNode.text === 'string') {\n\t\t\tresult += anyNode.text;\n\t\t}\n\n\t\t// Handle custom 'choice' nodes\n\t\tif (anyNode.type === 'choice') {\n\t\t\tconst attrs = anyNode.attrs || {};\n\t\t\tconst options = Array.isArray(attrs.options) ? attrs.options : [];\n\t\t\tconst selected = attrs.selectedOption || options[0] || '';\n\t\t\tif (typeof selected === 'string') {\n\t\t\t\tresult += selected;\n\t\t\t}\n\t\t}\n\n\t\t// Recurse into children\n\t\tif (Array.isArray(anyNode.content)) {\n\t\t\tanyNode.content.forEach((child: JSONContent) => walk(child));\n\t\t}\n\t}\n\n\twalk(content);\n\treturn result.trim();\n}\n"],"mappings":";AAMO,SAAS,eAAe,SAA8B;AAC5D,MAAI,SAAS;AAEb,WAAS,KAAK,MAAmB;AAChC,UAAM,UAAU;AAGhB,QAAI,OAAO,QAAQ,SAAS,UAAU;AACrC,gBAAU,QAAQ;AAAA,IACnB;AAGA,QAAI,QAAQ,SAAS,UAAU;AAC9B,YAAM,QAAQ,QAAQ,SAAS,CAAC;AAChC,YAAM,UAAU,MAAM,QAAQ,MAAM,OAAO,IAAI,MAAM,UAAU,CAAC;AAChE,YAAM,WAAW,MAAM,kBAAkB,QAAQ,CAAC,KAAK;AACvD,UAAI,OAAO,aAAa,UAAU;AACjC,kBAAU;AAAA,MACX;AAAA,IACD;AAGA,QAAI,MAAM,QAAQ,QAAQ,OAAO,GAAG;AACnC,cAAQ,QAAQ,QAAQ,CAAC,UAAuB,KAAK,KAAK,CAAC;AAAA,IAC5D;AAAA,EACD;AAEA,OAAK,OAAO;AACZ,SAAO,OAAO,KAAK;AACpB;","names":[]}